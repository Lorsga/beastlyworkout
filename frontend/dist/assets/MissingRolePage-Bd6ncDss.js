import{u as p,r,j as e,N as l,b as g,L as b,t as x,d as f}from"./index-D3l-U9gv.js";import{t as u}from"./firestore-CSdz_xXz.js";const j=new Set(["lrnz.sga@gmail.com"]);function y(){const{user:o,role:c}=p(),[i,a]=r.useState(""),[n,s]=r.useState(!1);if(!o)return e.jsx(l,{to:"/auth",replace:!0});if(c)return e.jsx(l,{to:c==="client"?"/app/client":"/app/coach",replace:!0});const d=j.has((o.email??"").toLowerCase());async function m(){s(!0),a("");try{const t=await x();a(t.alreadyAdmin?"Utente già admin. Refresh token completato.":"Ruolo admin assegnato.")}catch(t){a(u(t))}finally{s(!1)}}async function h(){s(!0),a("");try{await f(),a("Token aggiornato. Se il ruolo è presente verrai reindirizzato automaticamente.")}catch(t){a(u(t))}finally{s(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Accesso PT/Admin"}),e.jsx("h1",{children:"Completa accesso area coach"}),e.jsxs("p",{className:"hero-sub",children:["Hai fatto accesso con ",e.jsx("strong",{children:o.email}),". Se questo è il tuo account PT/Admin, completa la verifica qui sotto."]}),d?e.jsx("button",{className:"btn",disabled:n,onClick:()=>void m(),type:"button",children:"Attiva account PT/Admin"}):e.jsx("p",{className:"hint",children:"Questo account non è tra quelli autorizzati come PT/Admin. Esci e accedi con l'account corretto."}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void h(),type:"button",children:"Verifica di nuovo accesso"}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void g(),type:"button",children:"Esci e cambia account"}),e.jsxs("p",{className:"hint",children:["Accesso utente standard: ",e.jsx(b,{to:"/onboarding",children:"continua onboarding"}),"."]}),i?e.jsx("p",{className:"message",children:i}):null]})})}export{y as MissingRolePage};
