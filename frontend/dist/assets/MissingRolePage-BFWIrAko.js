import{u as h,r as c,j as e,N as l,n as g,L as b,o as x,p as j}from"./index-CoI36gfN.js";import{t as u}from"./firestore-CSdz_xXz.js";const f=new Set(["lrnz.sga@gmail.com"]);function S(){const{user:s,role:i}=h(),[r,a]=c.useState(""),[n,o]=c.useState(!1);if(!s)return e.jsx(l,{to:"/auth",replace:!0});if(i)return e.jsx(l,{to:i==="client"?"/app/client":"/app/coach",replace:!0});const m=f.has((s.email??"").toLowerCase());async function d(){o(!0),a("");try{const t=await x();a(t.alreadyAdmin?"Utente già admin. Refresh token completato.":"Ruolo admin assegnato.")}catch(t){a(u(t))}finally{o(!1)}}async function p(){o(!0),a("");try{await j(),a("Token aggiornato. Se il ruolo è presente verrai reindirizzato automaticamente.")}catch(t){a(u(t))}finally{o(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Ruolo non trovato"}),e.jsx("h1",{children:"Setup ruolo PT/Admin"}),e.jsxs("p",{className:"hero-sub",children:["Sei autenticato come ",e.jsx("strong",{children:s.email})," ma non hai claim ruolo. Da qui puoi completare setup admin o aggiornare i claim."]}),m?e.jsx("button",{className:"btn",disabled:n,onClick:()=>void d(),type:"button",children:"Sono PT: bootstrap admin"}):e.jsx("p",{className:"hint",children:"Questo account non è abilitato al bootstrap admin. Usa l'account PT oppure vai su onboarding cliente."}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void p(),type:"button",children:"Aggiorna token ruolo"}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void g(),type:"button",children:"Esci e cambia account"}),e.jsxs("p",{className:"hint",children:["Utente normale? Vai su ",e.jsx(b,{to:"/onboarding",children:"onboarding cliente"}),"."]}),r?e.jsx("p",{className:"message",children:r}):null]})})}export{S as MissingRolePage};
