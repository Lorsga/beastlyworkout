import{u as p,r as i,j as e,N as l,L as h,o as g,p as f}from"./index-DbDU9rQz.js";import{t as c}from"./firestore-CSdz_xXz.js";function j(){const{user:u,role:s}=p(),[r,a]=i.useState(""),[n,o]=i.useState(!1);if(!u)return e.jsx(l,{to:"/auth",replace:!0});if(s)return e.jsx(l,{to:s==="client"?"/app/client":"/app/coach",replace:!0});async function m(){o(!0),a("");try{const t=await g();a(t.alreadyAdmin?"Utente già admin. Refresh token completato.":"Ruolo admin assegnato.")}catch(t){a(c(t))}finally{o(!1)}}async function d(){o(!0),a("");try{await f(),a("Token aggiornato. Se il ruolo è presente verrai reindirizzato automaticamente.")}catch(t){a(c(t))}finally{o(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Ruolo non trovato"}),e.jsx("h1",{children:"Completa bootstrap utente"}),e.jsx("p",{className:"hero-sub",children:"L'utente è autenticato ma non ha claim di ruolo. Puoi forzare bootstrap primo admin o aggiornare i claim."}),e.jsx("button",{className:"btn",disabled:n,onClick:()=>void m(),type:"button",children:"Bootstrap primo admin"}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void d(),type:"button",children:"Aggiorna token ruolo"}),e.jsxs("p",{className:"hint",children:["Dopo assegnazione ruolo via backend, usa refresh token e torna a ",e.jsx(h,{to:"/auth",children:"login"}),"."]}),r?e.jsx("p",{className:"message",children:r}):null]})})}export{j as MissingRolePage};
