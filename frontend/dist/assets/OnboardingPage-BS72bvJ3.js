import{u as C,a as S,b as E,r as t,j as e,N as p,l as P,d as w,w as z}from"./index-CLZ1V8Um.js";import{t as D}from"./firestore-DB3C5Wwr.js";function L(){const{user:n,role:o}=C(),g=S(),{showError:h,showSuccess:b}=E(),[i,x]=t.useState((n==null?void 0:n.displayName)??""),[s,v]=t.useState(""),[r,j]=t.useState("beginner"),[l,f]=t.useState(3),[c,N]=t.useState(""),[u,d]=t.useState(!1);if(!n)return e.jsx(p,{to:"/auth",replace:!0});if(o==="admin"||o==="trainer")return e.jsx(p,{to:"/app/coach",replace:!0});const m=n.email??"";async function y(){d(!0);try{await w({displayName:i.trim(),email:m,role:"client",requestedRole:"client",onboardingStatus:"completed",onboardingCompleted:!0,onboardingUpdatedAt:new Date().toISOString()}),await z("onboarding",{goal:s.trim(),experienceLevel:r,trainingDaysPerWeek:l,notes:c.trim()}),b("Perfetto, profilo salvato."),g("/app/client",{replace:!0})}catch(a){h(D(a))}finally{d(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Onboarding Cliente"}),e.jsx("h1",{children:"Partiamo con i tuoi obiettivi"}),e.jsxs("p",{className:"hero-sub",children:["Completa queste informazioni per iniziare al meglio. Account: ",e.jsx("strong",{children:m})]}),e.jsxs("label",{children:["Come ti chiami?",e.jsx("input",{value:i,onChange:a=>x(a.target.value),placeholder:"Nome e cognome"})]}),e.jsxs("label",{children:["Qual Ã¨ il tuo obiettivo?",e.jsx("input",{value:s,onChange:a=>v(a.target.value),placeholder:"Es. perdere peso, aumentare forza, tonificare"})]}),e.jsxs("label",{children:["Livello di allenamento",e.jsxs("select",{value:r,onChange:a=>j(a.target.value),children:[e.jsx("option",{value:"beginner",children:"Principiante"}),e.jsx("option",{value:"intermediate",children:"Intermedio"}),e.jsx("option",{value:"advanced",children:"Avanzato"})]})]}),e.jsxs("label",{children:["Quanti giorni ti alleni a settimana?",e.jsx("input",{value:l,onChange:a=>f(Number(a.target.value)),type:"number",min:1,max:7})]}),e.jsxs("label",{children:["Informazioni utili",e.jsx("textarea",{value:c,onChange:a=>N(a.target.value),placeholder:"Es. infortuni, orari preferiti, esigenze specifiche"})]}),e.jsx("button",{className:"btn",disabled:u||!i||!s,type:"button",onClick:()=>void y(),children:u?"Salvataggio...":"Continua"}),e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>void P(),children:"Esci e cambia account"})]})})}export{L as OnboardingPage};
