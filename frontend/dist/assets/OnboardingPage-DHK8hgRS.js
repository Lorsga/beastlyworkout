import{u as S,r as t,j as e,N as h,n as y,L as C,q as O,t as P}from"./index-CoI36gfN.js";import{t as z}from"./firestore-CSdz_xXz.js";function k(){const{user:n,role:o}=S(),[i,x]=t.useState((n==null?void 0:n.displayName)??""),[s,b]=t.useState(""),[r,v]=t.useState("beginner"),[c,j]=t.useState(3),[u,N]=t.useState(""),[d,g]=t.useState(!1),[m,l]=t.useState("");if(!n)return e.jsx(h,{to:"/auth",replace:!0});if(o)return e.jsx(h,{to:o==="client"?"/app/client":"/app/coach",replace:!0});const p=n.email??"";async function f(){g(!0),l("");try{await O({displayName:i.trim(),email:p,requestedRole:"client",onboardingStatus:"pending-role",onboardingUpdatedAt:new Date().toISOString()}),await P("onboarding",{goal:s.trim(),experienceLevel:r,trainingDaysPerWeek:c,notes:u.trim()}),l("Onboarding salvato. Ora il PT/Admin deve assegnarti il ruolo client.")}catch(a){l(z(a))}finally{g(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Onboarding Cliente"}),e.jsx("h1",{children:"Completa i dati iniziali"}),e.jsxs("p",{className:"hero-sub",children:["Non hai ancora un ruolo assegnato, ma puoi completare il profilo. Account: ",e.jsx("strong",{children:p})]}),e.jsxs("label",{children:["Nome visualizzato",e.jsx("input",{value:i,onChange:a=>x(a.target.value),placeholder:"Nome e cognome"})]}),e.jsxs("label",{children:["Obiettivo principale",e.jsx("input",{value:s,onChange:a=>b(a.target.value),placeholder:"es. Dimagrire, forza, ricomposizione"})]}),e.jsxs("label",{children:["Livello",e.jsxs("select",{value:r,onChange:a=>v(a.target.value),children:[e.jsx("option",{value:"beginner",children:"beginner"}),e.jsx("option",{value:"intermediate",children:"intermediate"}),e.jsx("option",{value:"advanced",children:"advanced"})]})]}),e.jsxs("label",{children:["Giorni di allenamento a settimana",e.jsx("input",{value:c,onChange:a=>j(Number(a.target.value)),type:"number",min:1,max:7})]}),e.jsxs("label",{children:["Note aggiuntive",e.jsx("textarea",{value:u,onChange:a=>N(a.target.value),placeholder:"infortuni, preferenze, disponibilitÃ ..."})]}),e.jsx("button",{className:"btn",disabled:d||!i||!s,type:"button",onClick:()=>void f(),children:d?"Salvataggio...":"Salva onboarding"}),e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>void y(),children:"Esci e cambia account"}),e.jsxs("p",{className:"hint",children:["Sei PT/Admin? Vai a ",e.jsx(C,{to:"/missing-role",children:"setup admin"}),"."]}),m?e.jsx("p",{className:"message",children:m}):null]})})}export{k as OnboardingPage};
