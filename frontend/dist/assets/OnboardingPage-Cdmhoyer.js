import{u as y,r as t,j as e,N as h,l as S,v as C,w as z}from"./index-CrAJx4So.js";import{t as P}from"./firestore-CSdz_xXz.js";function E(){const{user:n,role:r}=y(),[i,b]=t.useState((n==null?void 0:n.displayName)??""),[s,x]=t.useState(""),[l,v]=t.useState("beginner"),[c,j]=t.useState(3),[u,N]=t.useState(""),[d,g]=t.useState(!1),[m,o]=t.useState("");if(!n)return e.jsx(h,{to:"/auth",replace:!0});if(r)return e.jsx(h,{to:r==="client"?"/app/client":"/app/coach",replace:!0});const p=n.email??"";async function f(){g(!0),o("");try{await C({displayName:i.trim(),email:p,requestedRole:"client",onboardingStatus:"pending-role",onboardingUpdatedAt:new Date().toISOString()}),await z("onboarding",{goal:s.trim(),experienceLevel:l,trainingDaysPerWeek:c,notes:u.trim()}),o("Perfetto, dati salvati. Il tuo percorso iniziale è stato registrato.")}catch(a){o(P(a))}finally{g(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Onboarding Cliente"}),e.jsx("h1",{children:"Partiamo con i tuoi obiettivi"}),e.jsxs("p",{className:"hero-sub",children:["Completa queste informazioni per iniziare al meglio. Account: ",e.jsx("strong",{children:p})]}),e.jsxs("label",{children:["Nome visualizzato",e.jsx("input",{value:i,onChange:a=>b(a.target.value),placeholder:"Nome e cognome"})]}),e.jsxs("label",{children:["Obiettivo principale",e.jsx("input",{value:s,onChange:a=>x(a.target.value),placeholder:"es. Dimagrire, forza, ricomposizione"})]}),e.jsxs("label",{children:["Livello",e.jsxs("select",{value:l,onChange:a=>v(a.target.value),children:[e.jsx("option",{value:"beginner",children:"beginner"}),e.jsx("option",{value:"intermediate",children:"intermediate"}),e.jsx("option",{value:"advanced",children:"advanced"})]})]}),e.jsxs("label",{children:["Giorni di allenamento a settimana",e.jsx("input",{value:c,onChange:a=>j(Number(a.target.value)),type:"number",min:1,max:7})]}),e.jsxs("label",{children:["Note aggiuntive",e.jsx("textarea",{value:u,onChange:a=>N(a.target.value),placeholder:"infortuni, preferenze, disponibilità..."})]}),e.jsx("button",{className:"btn",disabled:d||!i||!s,type:"button",onClick:()=>void f(),children:d?"Salvataggio...":"Salva onboarding"}),e.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>void S(),children:"Esci e cambia account"}),m?e.jsx("p",{className:"message",children:m}):null]})})}export{E as OnboardingPage};
