import{u as p,r,j as e,N as l,b,L as g,t as f,d as x}from"./index-CubVF6E_.js";import{i as j}from"./admin-B5do5RBX.js";import{t as d}from"./firestore-CSdz_xXz.js";function v(){const{user:o,role:i}=p(),[c,a]=r.useState(""),[n,s]=r.useState(!1);if(!o)return e.jsx(l,{to:"/auth",replace:!0});if(i)return e.jsx(l,{to:i==="client"?"/app/client":"/app/coach",replace:!0});const u=j(o.email);async function m(){s(!0),a("");try{const t=await f();a(t.alreadyAdmin?"Utente già admin. Refresh token completato.":"Ruolo admin assegnato.")}catch(t){a(d(t))}finally{s(!1)}}async function h(){s(!0),a("");try{await x(),a("Token aggiornato. Se il ruolo è presente verrai reindirizzato automaticamente.")}catch(t){a(d(t))}finally{s(!1)}}return e.jsx("main",{className:"page page-center",children:e.jsxs("section",{className:"card auth-card",children:[e.jsx("p",{className:"eyebrow",children:"Accesso PT/Admin"}),e.jsx("h1",{children:"Completa accesso area coach"}),e.jsxs("p",{className:"hero-sub",children:["Hai fatto accesso con ",e.jsx("strong",{children:o.email}),". Se questo è il tuo account PT/Admin, completa la verifica qui sotto."]}),u?e.jsx("button",{className:"btn",disabled:n,onClick:()=>void m(),type:"button",children:"Attiva account PT/Admin"}):e.jsx("p",{className:"hint",children:"Questo account non è tra quelli autorizzati come PT/Admin. Esci e accedi con l'account corretto."}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void h(),type:"button",children:"Verifica di nuovo accesso"}),e.jsx("button",{className:"btn btn-ghost",disabled:n,onClick:()=>void b(),type:"button",children:"Esci e cambia account"}),e.jsxs("p",{className:"hint",children:["Accesso utente standard: ",e.jsx(g,{to:"/onboarding",children:"continua onboarding"}),"."]}),c?e.jsx("p",{className:"message",children:c}):null]})})}export{v as MissingRolePage};
