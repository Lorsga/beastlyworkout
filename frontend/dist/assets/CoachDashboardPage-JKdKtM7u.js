import{u as q,r as t,j as e,o as G,e as L,f as B,p as H,q as J,s as K,t as O}from"./index-CNYxnOg5.js";import{A as Q}from"./AppShell-BAmvCuVr.js";import{m as g,t as A}from"./firestore-CSdz_xXz.js";function Y(){const{role:l}=q(),[P,T]=t.useState([]),[v,U]=t.useState([]),[D,I]=t.useState([]),[m,i]=t.useState(""),[C,S]=t.useState(""),[n,c]=t.useState(!1),[a,r]=t.useState(""),[d,R]=t.useState(""),[b,k]=t.useState("active"),[N,E]=t.useState("check-in"),[u,M]=t.useState(""),[h,w]=t.useState(""),[p,F]=t.useState(""),[f,z]=t.useState("client");async function y(){if(l){c(!0),i("");try{const[s,x,j]=await Promise.all([G(),L(l),B(l)]);T(g(s.docs)),U(g(x.docs)),I(g(j.docs))}catch(s){i(A(s))}finally{c(!1)}}}t.useEffect(()=>{y()},[l]);async function o(s,x){S(""),i(""),c(!0);try{await s(),S(x),await y()}catch(j){i(A(j))}finally{c(!1)}}return e.jsxs(Q,{role:l==="trainer"?"trainer":"admin",subtitle:"Gestione clienti, piani e sessioni in un unico pannello operativo.",title:"Dashboard Coach",children:[e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Associa Cliente"}),e.jsxs("label",{children:["Client UID",e.jsx("input",{value:a,onChange:s=>r(s.target.value),placeholder:"uid cliente"})]}),e.jsx("button",{className:"btn",disabled:!a||n,onClick:()=>void o(()=>H(a),"Cliente associato."),type:"button",children:"Associa"})]}),e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Nuovo Piano"}),e.jsxs("label",{children:["Client UID",e.jsx("input",{value:a,onChange:s=>r(s.target.value),placeholder:"uid cliente"})]}),e.jsxs("label",{children:["Titolo piano",e.jsx("input",{value:d,onChange:s=>R(s.target.value),placeholder:"Forza 4 settimane"})]}),e.jsxs("label",{children:["Stato",e.jsxs("select",{value:b,onChange:s=>k(s.target.value),children:[e.jsx("option",{value:"draft",children:"draft"}),e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"archived",children:"archived"})]})]}),e.jsx("button",{className:"btn",disabled:!a||!d||n,onClick:()=>void o(()=>J({clientId:a,title:d,status:b}),"Piano creato."),type:"button",children:"Crea piano"})]}),e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Nuova Sessione"}),e.jsxs("label",{children:["Client UID",e.jsx("input",{value:a,onChange:s=>r(s.target.value),placeholder:"uid cliente"})]}),e.jsxs("label",{children:["Inizio",e.jsx("input",{value:u,onChange:s=>M(s.target.value),type:"datetime-local"})]}),e.jsxs("label",{children:["Fine",e.jsx("input",{value:h,onChange:s=>w(s.target.value),type:"datetime-local"})]}),e.jsxs("label",{children:["Tipo",e.jsx("input",{value:N,onChange:s=>E(s.target.value),placeholder:"workout o check-in"})]}),e.jsx("button",{className:"btn",disabled:!a||!u||!h||n,onClick:()=>void o(()=>K({clientId:a,startsAt:u,endsAt:h,type:N}),"Sessione creata."),type:"button",children:"Crea sessione"})]}),l==="admin"?e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Assegna ruolo utente"}),e.jsxs("label",{children:["User UID",e.jsx("input",{value:p,onChange:s=>F(s.target.value),placeholder:"uid utente"})]}),e.jsxs("label",{children:["Ruolo",e.jsxs("select",{value:f,onChange:s=>z(s.target.value),children:[e.jsx("option",{value:"admin",children:"admin"}),e.jsx("option",{value:"trainer",children:"trainer"}),e.jsx("option",{value:"client",children:"client"})]})]}),e.jsx("button",{className:"btn",disabled:!p||n,onClick:()=>void o(()=>O(p,f),"Ruolo aggiornato."),type:"button",children:"Applica ruolo"})]}):null,e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Dati operativi"}),e.jsxs("p",{className:"hint",children:["Clienti associati: ",P.length]}),e.jsxs("p",{className:"hint",children:["Piani: ",v.length]}),e.jsxs("p",{className:"hint",children:["Sessioni: ",D.length]}),e.jsx("ul",{className:"list",children:v.slice(0,5).map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.title})," · ",s.status," · client ",s.clientId]},s.id))})]}),n?e.jsx("p",{className:"message",children:"Caricamento..."}):null,C?e.jsx("p",{className:"message success",children:C}):null,m?e.jsx("p",{className:"message",children:m}):null]})}export{Y as CoachDashboardPage};
