import{u as G,r as a,j as e,o as q,f as B,h as L,p as H,q as J,s as K,t as O}from"./index-C6aJxY-I.js";import{A as Q}from"./AppShell-BpZOOKnV.js";import{m as x,t as y}from"./firestore-BAizMrXz.js";function Y(){const{role:l}=G(),[P,T]=a.useState([]),[j,I]=a.useState([]),[k,E]=a.useState([]),[v,i]=a.useState(""),[C,S]=a.useState(""),[n,c]=a.useState(!1),[t,r]=a.useState(""),[d,R]=a.useState(""),[b,D]=a.useState("active"),[f,M]=a.useState("check-in"),[u,U]=a.useState(""),[h,z]=a.useState(""),[p,w]=a.useState(""),[A,F]=a.useState("client");async function N(){if(l){c(!0),i("");try{const[s,m,g]=await Promise.all([q(),B(l),L(l)]);T(x(s.docs)),I(x(m.docs)),E(x(g.docs))}catch(s){i(y(s))}finally{c(!1)}}}a.useEffect(()=>{N()},[l]);async function o(s,m){S(""),i(""),c(!0);try{await s(),S(m),await N()}catch(g){i(y(g))}finally{c(!1)}}return e.jsxs(Q,{role:l==="trainer"?"trainer":"admin",subtitle:"Gestisci clienti, programmi e appuntamenti da un unico posto.",title:"Area Coach",children:[e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Collega un cliente"}),e.jsxs("label",{children:["Codice cliente",e.jsx("input",{value:t,onChange:s=>r(s.target.value),placeholder:"Inserisci il codice cliente"})]}),e.jsx("button",{className:"btn",disabled:!t||n,onClick:()=>void o(()=>H(t),"Cliente associato."),type:"button",children:"Collega cliente"})]}),e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Crea un programma"}),e.jsxs("label",{children:["Codice cliente",e.jsx("input",{value:t,onChange:s=>r(s.target.value),placeholder:"Inserisci il codice cliente"})]}),e.jsxs("label",{children:["Titolo programma",e.jsx("input",{value:d,onChange:s=>R(s.target.value),placeholder:"Forza 4 settimane"})]}),e.jsxs("label",{children:["Stato programma",e.jsxs("select",{value:b,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"draft",children:"Bozza"}),e.jsx("option",{value:"active",children:"Attivo"}),e.jsx("option",{value:"archived",children:"Archiviato"})]})]}),e.jsx("button",{className:"btn",disabled:!t||!d||n,onClick:()=>void o(()=>J({clientId:t,title:d,status:b}),"Programma creato con successo."),type:"button",children:"Salva programma"})]}),e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Pianifica una sessione"}),e.jsxs("label",{children:["Codice cliente",e.jsx("input",{value:t,onChange:s=>r(s.target.value),placeholder:"Inserisci il codice cliente"})]}),e.jsxs("label",{children:["Data e ora inizio",e.jsx("input",{value:u,onChange:s=>U(s.target.value),type:"datetime-local"})]}),e.jsxs("label",{children:["Data e ora fine",e.jsx("input",{value:h,onChange:s=>z(s.target.value),type:"datetime-local"})]}),e.jsxs("label",{children:["Tipo sessione",e.jsx("input",{value:f,onChange:s=>M(s.target.value),placeholder:"Es. allenamento, check-in"})]}),e.jsx("button",{className:"btn",disabled:!t||!u||!h||n,onClick:()=>void o(()=>K({clientId:t,startsAt:u,endsAt:h,type:f}),"Sessione pianificata con successo."),type:"button",children:"Salva sessione"})]}),l==="admin"?e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Gestione accessi"}),e.jsxs("label",{children:["Codice utente",e.jsx("input",{value:p,onChange:s=>w(s.target.value),placeholder:"Inserisci il codice utente"})]}),e.jsxs("label",{children:["Profilo accesso",e.jsxs("select",{value:A,onChange:s=>F(s.target.value),children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"trainer",children:"Coach"}),e.jsx("option",{value:"client",children:"Cliente"})]})]}),e.jsx("button",{className:"btn",disabled:!p||n,onClick:()=>void o(()=>O(p,A),"Accesso aggiornato."),type:"button",children:"Aggiorna accesso"})]}):null,e.jsxs("article",{className:"card",children:[e.jsx("h2",{children:"Panoramica"}),e.jsxs("p",{className:"hint",children:["Clienti collegati: ",P.length]}),e.jsxs("p",{className:"hint",children:["Programmi creati: ",j.length]}),e.jsxs("p",{className:"hint",children:["Sessioni in agenda: ",k.length]}),e.jsx("ul",{className:"list",children:j.slice(0,5).map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.title})," · ",s.status," · cliente ",s.clientId]},s.id))})]}),n?e.jsx("p",{className:"message",children:"Caricamento..."}):null,C?e.jsx("p",{className:"message success",children:C}):null,v?e.jsx("p",{className:"message",children:v}):null]})}export{Y as CoachDashboardPage};
